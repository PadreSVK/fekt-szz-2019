**OtÃ¡zky k SZZ pro akademickÃ½ rok 2018/19**

**1. ZÃ¡kladnÃ­ architektura AVR mikroprocesorÅ¯, rozdÄ›lenÃ­ AVR
mikroprocesorÅ¯, dostupnÃ© perifÃ©rie, zÃ¡klady prÃ¡ce s registry -- binÃ¡rnÃ­
zÃ¡pis, hexadecimÃ¡lnÃ­, bitovÃ½ posun, nulovÃ¡nÃ­ pÅ™Ã­znaku.**

**ArchitektÃºra AVR a dostupnÃ© perifÃ©rie**

-   8-bit microcontroller

-   ModifikovanÃ¡ harvardskÃ¡ architektÃºra

-   RISC

-   IntegrovanÃ¡ Flash pamÃ¤Å¥

-   IntegrovanÃ¡ SRAM

-   IntegrovanÃ¡ EEPROM

-   A/D prevodnÃ­ky (10 alebo 12-bit)

-   VnÃºtornÃ½ RC oscilÃ¡tor, vstupy pre externÃ½ oscilÃ¡tor

-   SÃ©riovÃ© rozhranie USART, SPI a I2C

-   8 alebo 16 bit ÄasovaÄe

-   PWM

-   GPIO piny

**Rozdelenie**

-   ATtiny

-   ATmega

-   ATxmega

-   ...

ÄŒÃ­slo v nÃ¡zve znamenÃ¡ veÄ¾kosÅ¥ flash pamÃ¤te, napr. ATmega328p mÃ¡ 32kB

**BinÃ¡rny zÃ¡pis** - 0b01001011

**Hex zÃ¡pis** - 0x4b

**BitovÃ½ posun** - 0x4b \<\< 1

**Nulovanie prÃ­znaku** - 0b01001011 & 11111110 = 0b01001010

JednotlivÃ© bity registorv majÃº svoje menÃ¡

![](./assets/media/image1.png){width="3.7864588801399823in"
height="0.9890912073490814in"}

TakÅ¾e vieme nastavovaÅ¥ prÃ­znaky aj pomocou but shiftu: PORTA \|= (1 \<\<
PORTA2)

**IO porty**

8-bit registre PORT A-G, kaÅ¾dÃ½ port mÃ¡ asociaovanÃ© 3 registre

**PORTn** - slÃºÅ¾i na uloÅ¾enie vÃ½stupnÃ½ch hodnÃ´t

**DDRn** - data direction register - zapÃ­sanÃ­m 1 nastavÃ­me ako vÃ½stup, 0
ako bstup

**PINn** - sÃ´ÃºÅ¾i pre naÄÃ­tanie hodnÃ´t zo vstupnÃ½ch zariadenÃ­

**2. PamÄ›tnÃ­ prostor mikroprocesoru AVR - FLASH pamÄ›Å¥, SRAM pamÄ›Å¥,
EEPROM pamÄ›Å¥.**

AVR vyuÅ¾Ã­va harvardskÃº architektÃºru, takÅ¾e je oddelenÃ¡ pamÃ¤Å¥ pre program
a dÃ¡ta.

Program je uloÅ¾enÃ½ vo flash (non-volatile), dÃ¡ta sÃº v RAM (volatile).
EEPROM je non-volatile pamÃ¤Å¥ kde si vieme ukladaÅ¥ napr. Config.

**Flash**

VeÄ¾kosÅ¥ sa lÃ­Å¡i Äip od Äipu... 32 kB, 64 kB, 128 kB, ...

KeÄÅ¾e sÃº vÅ¡etky AVR inÅ¡trukcie 16-bitovÃ©, programovÃ¡ pamÃ¤Å¥ je
organizovanÃ¡ po 16 bitoch. Pre flash pamÃ¤Å¥ zaruÄuje Atmel minimÃ¡lne
10000 programovacÃ­ch cyklov.

**SRAM**

UkladajÃº sa premennÃ©, proste RAMka, stack programu, halda, etc...

SRAM zaÄÃ­na niekoÄ¾kÃ½mi bajtami vyhradenÃ½mi pre GPIO registre, Äalej
bajty pre I/O pamÃ¤Å¥, nejakÃ© B pre externÃº I/O pamÃ¤Å¥, ÄalÅ¡Ã­ blok 8 kB je
vyhradenÃ½ pre samotnÃº SRAM

![](./assets/media/image33.png){width="5.977882764654418in"
height="3.1093755468066493in"}

VeÄ¾kosti SRAM sa pohybujÃº od 2 kB (ATmega 328) do 32 kB (ATxmega rada)

**EEPROM** (Electricaly Erasable PROM)

Non volatile, je pomalÅ¡ia na zÃ¡pis a ÄÃ­tanie, ale zachovÃ¡va dÃ¡ta, takÅ¾e
je dobrÃ¡ na uloÅ¾enie konfigurÃ¡cie, etc. ATmega1281 mÃ¡ 4 kB, ATmega328P
mÃ¡ 1 kB, obmedzenÃ½ poÄet zÃ¡pisov, cca 10 000.

**3. SÃ©riovÃ½ pÅ™enos dat. SbÄ›rnice USART, parametry komunikace, parita,
baudrate, asynchronnÃ­ versus synchronnÃ­ reÅ¾im, pÅ™enosovÃ© rychlosti.**

**SbÄ›rnice SPI, zÃ¡kladnÃ­ charakteristika, propojenÃ­ dvou SPI zaÅ™Ã­zenÃ­.
SbÄ›rnice I2C,zÃ¡kladnÃ­ charakteristika, adresovÃ¡nÃ­ zaÅ™Ã­zenÃ­.**

**SynchrÃ³nny vs. asynchrÃ³nny reÅ¾im**

SynchrÃ³nny reÅ¾im znamenÃ¡, Å¾e sa na synchornizÃ¡ciu pouÅ¾Ã­va clock signÃ¡l
(SPI, I2C), u asynchrÃ³nneho mÃ³du sa pouÅ¾Ã­va start a stop bit (USART).

**USART**

SÃ©riovÃ© rozhranie, dÃ¡ta sÃº posielanÃ© bit za bitom po jednom spoji.
PouÅ¾Ã­va dve linky, Rx a Tx. Full duplex. Je asynchrÃ³nny, pre rozpoznanie
Å¡tartu a konca vysielania pouÅ¾Ã­vajÃº start a stop bity indikujÃºce
zaÄiatok a koniec rÃ¡mca.

KomunikujÃº iba dve zariadenie. RÃ½chlosti, common 9600 - 115200 bps.

Parity bit

-   Error checking

<!-- -->

-   PoslednÃ½ bit prenÃ¡Å¡anÃ½ch dÃ¡t nahradÃ­m paritnÃ½b bitom (nepoÅ¡lem bajt
    > ale 7 bitov + jeden parirnÃ½ bit)

-   Ak je to 1, znamenÃ¡ to Å¾e som preniesol pÃ¡rny poÄet jednotiek
    > (vrÃ¡tane parity bitu)

-   Ak je to 0, znamenÃ¡ to Å¾e Å¾e som preniesol nepÃ¡rny poÄet jednotiek

![](./assets/media/image32.png){width="4.557292213473316in"
height="2.144607392825897in"}

**SPI**

Zbernica pre vysokorÃ½chlostnÃ½ prenos medzi mikrokontrolÃ©rom a
perifÃ©riami. V prÃ­pade Å¾e druhÃ¡ strana API nemÃ¡, dÃ¡ sa nakonfigurovaÅ¥
USART do SPI mÃ³du. Je synchrÃ³nny, pouÅ¾Ã­va sa clock signÃ¡l. MÃ¡ celkovo 3
vodiÄe, jeden dva dÃ¡tovÃ© pre oba smery a jeden pre hodinovÃ½ signÃ¡l.
Master-slave konfigurÃ¡cia. PouÅ¾Ã­va sa eÅ¡te slave-select pin na select
zariadenie s ktorÃ½m idem komunikovaÅ¥. ProgramovateÄ¾nÃ© rÃ½chlosti aÅ¾ do
2MB/s. Full duplex.

![](./assets/media/image17.png){width="3.7916666666666665in"
height="1.7708333333333333in"}

SCLK - clock

MOSI - master out slave in

MISO - master in slave out

SS - slave select

Priebeh komunikÃ¡cie

1.  Najprv master selectne slave tak Å¾e nastavÃ­ SS na log. 0

2.  Potom master zaÄne enerovaÅ¥ clock signal

3.  Prebieha vÃ½mena dÃ¡t cez MOSI a MISO

4.  Master ukonÄÃ­ komunikÃ¡ciu takÅ¾e prestane generovaÅ¥ clock signal a
    > zdvihne SS na log. 1

**I2C** (TWI, Two Wire Interface)

Phillips Semiconductor. DvojvodiÄovÃ¡ obojsmernÃ¡ zbernica podporujÃºca aÅ¾
128 zariadenÃ­ dohromady. KaÅ¾dÃ© zariadenie komunikujÃºce po zbernici mÃ¡
vlastnÃº adresu. MÃ´Å¾e byÅ¥ pripojenÃ½ch viacero masterov (MCUs) a vlacero
slaves (senzorov, diplejov, etc.). Master generuje hodinovÃ½ signÃ¡l. SDA
sa mÃ´Å¾e meniÅ¥ iba ak je SCL v log. 0. VÃ½nimkou je zaÄiatok a koniec
prenosu, kedy sa SCL najprv zdvihne na 1 a potom sa indikuje cez SDL
zaÄiatok alebo koniec prenosu nÃ¡stupnou alebo zostupnou hranou, tzn. Å¾e
kontrolnÃ© dÃ¡ta sa posielajÃº ak je SCL 1. PouÅ¾Ã­vajÃº sa ACK bity na
indikÃ¡ciu prijatÃ½ch
dÃ¡t.![](./assets/media/image6.png){width="3.070790682414698in"
height="1.671875546806649in"}

Priebeh:

1.  Master najprv vyÅ¡le start bit

2.  Potom vyÅ¡le 7b adresu

3.  Potom vyÅ¡le R/W bit (1 read, 0 write)

4.  Ak zariadenie rozpoznÃ¡ svoju adresu, posiela spÃ¤Å¥ ACK bit.

5.  NasledujÃº 8b data rÃ¡mce, kaÅ¾dÃ½ potvrdenÃ½ ACK bitom.

Adresa 0x00 je broadcast adresa.

![](./assets/media/image2.png){width="6.5in"
height="1.0972222222222223in"}

**4. Princip ÄÃ­taÄe s pÅ™eteÄenÃ­m, princip ÄÃ­taÄe s pÅ™eruÅ¡enÃ­m.
RozliÅ¡ovacÃ­ schopnost ÄÃ­taÄÅ¯. PulsnÄ› Å¡Ã­Å™kovÃ¡ modulace, stÅ™Ã­da.**

Odmeranie ÄasovÃ©ho Ãºseku sa realizuje napoÄÃ­tanÃ­m impulzov z ÄasovaÄa.

AVR mÃ¡ 8bit (0-255) a 16bit (0-65535) ÄasovaÄe. ÄŒasovaÄ je voÄ¾ne beÅ¾iaci
register (free running counter) a vlastnÃº hodnotu dokÃ¡Å¾e inkrementovaÅ¥ v
intervale Å¡pecifikovanom uÅ¾Ã­vateÄ¾om. Register zvyÅ¡uje svoju hodnotu
kaÅ¾dÃ½m prichÃ¡dzajÃºcom impulzom. VÄaka tomu Å¾e ÄasovaÄ pracuje nezÃ¡visle
na procesore, dokÃ¡Å¾e meriaÅ¥ Äas/frekvencu s vysokou presnosÅ¥ou. ÄŒasovaÄe
sa pouÅ¾Ã­vajÃº aj na PWM.

**ÄŒÃ­taÄ s preteÄenÃ­m**

ZaloÅ¾enÃ½ na vyvolanÃ­ preruÅ¡enia v prÃ­pade, Å¾e obsah ÄasovÃ©ho registra
odpovedÃ¡ jeho maximÃ¡lnej kapacite. PreruÅ¡enie je vyvolanÃ© po preteÄenÃ­.
Potom zaÄne register ÄÃ­taÅ¥ impulzy odznova.

![](./assets/media/image29.png){width="4.130208880139983in"
height="1.3962642169728783in"}

Ak je mikrokontrolÃ©r taktovanÃ½ an 8 MHz, tak jeden impulz trvÃ¡ 125ns a
register sa naplnÃ­ kaÅ¾dÃ½ch 32 us. K spomalenÃ­ ÄÃ­tania hodnÃ´t sa pouÅ¾Ã­va
preddeliÄka.

**ÄŒÃ­taÄ s porovnanÃ­m**

UmoÅ¾Åˆuje definovaÅ¥ vlastnÃ½ interval pomocou komparÃ¡tora. VoÄ¾ne beÅ¾iaci
cÃ­taÄ v kaÅ¾dom cykle kontroluje vlastnÃº hodnotu s hodnotou uloÅ¾enou v
komparaÄnom registri a v prÃ­pade zhody oznÃ¡mi tÃºto udalosÅ¥ preruÅ¡enÃ­m.
Potom sa ÄÃ­taÄ nuluje ÄÃ­ta znova od nuly.

![](./assets/media/image21.png){width="5.697916666666667in"
height="3.5208333333333335in"}

![](./assets/media/image11.png){width="3.0in"
height="0.7395833333333334in"}

**PWM** (Pulse Width Modulation)

ÄŒasovaÄe sa pouÅ¾Ã­vajÃº ku generovaniu signÃ¡lov s premennou ÃºrovÅˆou
napÃ¤tia. ZnÃ­Å¾enie napÃ¤tia sa dÃ¡ dosiehnÃºÅ¥ pulznom modulÃ¡ciou (PWM). PWM
slÃºÅ¾i k modulovanÃ­ stÅ™Ã­dy signÃ¡lu, Äo je percento Äasu, v ktorom signÃ¡l
je v stave HIGH v pomere k dÄºÅ¾e periÃ³dy
signÃ¡lu.![](./assets/media/image14.png){width="3.9563801399825023in"
height="2.2597298775153107in"}

**RozliÅ¡ovacia schopnosÅ¥ ÄasovaÄa**

ZÃ¡leÅ¾Ã­ na frekvencii ÄasovaÄa a pouÅ¾itÃ­ predeliÄky. VyÅ¡Å¡ia frekvencia mÃ¡
vyÅ¡Å¡iu presnosÅ¥ keÄÅ¾e sa impulzy generujÃº ÄastejÅ¡ie =\> preruÅ¡enie sa
deje ÄastejÅ¡ie.

**5. RozdÄ›lenÃ­ senzorÅ¯, princip senzoru teploty, popis negistoru, popis
zapojenÃ­ mÄ›Å™Ã­cÃ­ho pÅ™Ã­pravku s negistorem . ADC pÅ™evod-vzorkovÃ¡nÃ­,
kvantovÃ¡nÃ­, kÃ³dovÃ¡nÃ­, kvantizaÄnÃ­ chyba. Princip AD pÅ™evodnÃ­ku s
postupnou aproximacÃ­. Chybovost pÅ™evodnÃ­ku, chyba nastavenÃ­ nuly, chyba
zisku, integrÃ¡lnÃ­ a diferenciÃ¡lnÃ­ nelinearita.**

**ADC prevod**

**Vzorkovanie**

-   ZisÅ¥ovanie Ãºrovne analÃ³govÃ©ho signÃ¡lu v pravidelnÃ½ch intervaloch

-   Spravidla 0 - Ucc

-   Nyquistov teorÃ©m - f~vz~ \>= 2 \* f~sig~ (ak vzorkujem signÃ¡l v
    > rozmedzÃ­ 20 Hz aÅ¾ 4 kHz tak musÃ­m vzorkovaÅ¥ s frekvenciou aspoÅˆ 8
    > kHz)

**Kvantovanie**

-   Prevod vzorky ku kvantizaÄnej Ãºrovni

-   PoÄet ÃºrovnÃ­ zÃ¡leÅ¾Ã­ od ADC v mikrokontrolÃ©ri, u atmelu je to 10/12
    > bitov (1024, 4096 ÃºrovnÃ­)

-   RozlÃ­Å¡enie prevodnÃ­ka sa dÃ¡ vypoÄÃ­taÅ¥ ako pomer rozdielu ÃºrovnÃ­
    > napÃ¤tia a poÄtu kvantizaÄnÃ½ch hodnÃ´t

-   V prÃ­pade rozsahu napÃ¤tia 0 - 3,3 V je rozlÃ­Å¡enie 10b prevodnÃ­ka
    > 3,22 mV

-   U lineÃ¡rneho kvantizÃ¡tora je kvantizaÄnÃ¡ chyba +- polovica
    > rozlÃ­Å¡enia (+- 1,61 mV)

**KÃ³dovanie**

-   Vyjadrenie kvantizaÄnej Ãºrovne v binÃ¡rnej podobe

-   SignÃ¡l je reprezentovanÃ½ postupnos Å¥ou 10 bit d\'hodnÃ´t (u 10b ADC)

![](./assets/media/image13.png){width="3.1041666666666665in"
height="0.8125in"}

**ADC prevod s postupnou aproximÃ¡ciou**

KonkrÃ©tna implementÃ¡cia prevodnÃ­ka. Pri tejto metÃ³de je pouÅ¾itÃ½ DA
konvertor, kontrolÃ©r a aproximÃ¡tor.

![](./assets/media/image10.png){width="4.958333333333333in"
height="2.9375in"}

Na jeden vstup komparÃ¡toru je pÅ™iveden vstupnÃ­ mÄ›Å™enyÌ analogovyÌ signÃ¡l
ğ‘ˆin a na druhyÌ vstup je pÅ™iveden signÃ¡l s referenÄnÃ­m napÄ›tÃ­m ğ‘ˆin. CelyÌ
proces pÅ™evodu analogovÃ© hodnoty na digitÃ¡lnÃ­ spoÄÃ­vÃ¡ v porovnÃ¡vÃ¡nÃ­
vstupnÃ­ho signÃ¡lu s pomÄ›rovanyÌm referenÄnÃ­m signÃ¡lem. PoÄet porovnÃ¡nÃ­ je
zÃ¡vislÃ© na poÄtu bitÅ¯ pÅ™evodnÃ­ku. NÃ­Å¾e je uveden pÅ™Ã­klad pÅ™evodu pro
referenÄnÃ­ napÄ›tÃ­ 5 V.

Na zaÄÃ¡tku pÅ™evodu je spoleÄnÄ› se vstupnÃ­m signÃ¡lem na komparÃ¡tor
pÅ™ivedena hodnota 1/2 ğ‘ˆref. V pÅ™Ã­padÄ› 10-bit pÅ™evodnÃ­ku je tato hodnota
vyjÃ¡dÅ™ena jako 1000000000. DA konvertor tedy nastavÃ­ na nejvyÌznamnÄ›jÅ¡.m
MSB bitu (Most Significant Bit) hodnotu 1, pÅ™evede tuto digitÃ¡lnÃ­
hodnotu na analogovou a porovnÃ¡ se vstupnÃ­m napÄ›tÃ­m. LogickÃ¡ hodnota 1
pouze na MSB bitu tedy odpovÃ­dÃ¡ hodnotÄ› 512. V pÅ™Ã­padÄ› rozsahu 210 =
1024, odpovÃ­dÃ¡ tato hodnota poloviÄnÃ­mu rozsahu napÄ›tÃ­, pro rozsah 0 - 5
V je vygenerovÃ¡na hodnota referenÄnÃ­ho napÄ›tÃ­ 2,5 V. KomparÃ¡tor tedy
porovnÃ¡ obÄ› napÄ›Å¥ovÃ© ÃºrovnÄ› a pokud je vstupnÃ­ signÃ¡l vetÅ¡Ã­ neÅ¾
referenÄnÃ­ signÃ¡l (ğ‘ˆin \> ğ‘ˆref) kontrolÃ©r pÅ™edÃ¡ DA konvertoru logickou
hodnotu 1 na prvnÃ­m MSB. V opaÄnÃ©m pÅ™Ã­padÄ› je na pozici MSB vygenerovÃ¡na
hodnota 0. V dalÅ¡Ã­m kroku je k nastavenÃ© logickÃ© Ãºrovni na MSB bitu
pÅ™idÃ¡na logickÃ¡ 1 na druhyÌ MSB bit a opÄ›t je provedeno porovnÃ¡nÃ­
vstupnÃ­ho signÃ¡lu s novou referenÄnÃ­ napÄ›Å¥ovou ÃºrovnÃ­. V pÅ™Ã­padÄ›, Å¾e je
napÄ›Å¥ovÃ¡ ÃºroveÅˆ vstupnÃ­ho signÃ¡lu vÄ›tÅ¡Ã­ neÅ¾ referenÄnÃ­ho, ponechÃ¡ se
opÄ›t na druhÃ©m mÃ­stÄ› logickÃ¡ 1, jinak se nastavÃ­ logickÃ¡ 0. TÃ­mto
zpÅ¯sobem je porovnÃ¡no vÅ¡ech 10 bitÅ¯ referenÄnÃ­ho signÃ¡lu. Po kontrole
10tÃ©ho bitu je na vyÌstupu kontrolÃ©ru vyvedena posloupnost nastavenyÌch
bitÅ¯. TÃ­mto zpÅ¯sobem je proveden pÅ™evod analogovÃ©ho signÃ¡lu na digitÃ¡lnÃ­
pomocÃ­ postupnÃ© aproximace k nejbliÅ¾Å¡Ã­ hodnotÄ›. Na ObrÃ¡zku 5.3 je
znÃ¡zornÄ›n proces pro pÅ™evod analogovÃ©ho signÃ¡lu s napÄ›Å¥ovou ÃºrovnÃ­ 3,328
V. VyÌstupem pÅ™evodu je binÃ¡rnÃ­ hodnota 1010101001, kterÃ¡ odpovÃ­dÃ¡
hodnotÄ›

napÄ›tÃ­ 3,325 V. Chyba pÅ™evodu je tedy 3 mV. V tabulce 5.1 jsou uvedeny
prÅ¯bÄ›Å¾nÃ© vyÌpoÄtu pÅ™evodu. RozliÅ¡ovacÃ­ schopnost metody s postupnou
aproximacÃ­ je velmi vysokÃ¡, ovÅ¡em jeho pÅ™esnost je zÃ¡vislÃ¡ na pÅ™esnosti
DA pÅ™evodnÃ­ku.

![](./assets/media/image15.png){width="6.5in"
height="2.5555555555555554in"}

![](./assets/media/image36.png){width="6.5in"
height="8.86111111111111in"}

**ChybovosÅ¥ AD prevodnÃ­ka**

**Chyba nastavenia nuly** (Offset)

-   Hodnota napÃ¤tia vstupnÃ©ho signÃ¡lu, pri ktorej je vÃ½stupnÃ¡ binÃ¡rna
    > hodnota prevodnÃ­ka rovnÃ¡ nule

-   V prÃ­pade Å¾e je vÃ½stup prevodnÃ­ka 0 pri nenulovom napÃ¤tÃ­, je toto
    > napÃ¤tie oznaÄovanÃ© ako chyba offsetu, alebo chyba nastavenia nuly

**Chyba zisku** (Gain Error)

-   Popisuje napÃ¤Å¥ovÃ½ rozdiel poslednÃ©ho AD prevodu od ideÃ¡lnej
    > charakteristiky

**IntegrÃ¡lna nelinearita** (INL)

-   MaximÃ¡lny zaznamenanÃ½ rozdiel aktuÃ¡lneho a ideÃ¡lneho priebehu
    > prevodu

**DiferenciÃ¡lna nelinearita** (DNL)

-   MaximÃ¡lny rozsah napÃ¤tia v ktorom doÅ¡lo k zmene binÃ¡rnej hodnoty

![](./assets/media/image35.png){width="6.5in"
height="5.430555555555555in"}

**Rozdelenie senzorov**

Senzor je zariadenie ktorÃ© prevÃ¡dza akÃ½koÄ¾vek druh energie na
elektrickÃº.

**Priame a komplexnÃ© senzory**

-   Priamy senzok konvertuje energiu priamo na elektrickÃ½ signÃ¡l (napr.
    > termistor ktorÃ½ menÃ­ svoj odpor vzhÄ¾adom na teplotu)

-   KomplexnÃ½ senzor obsahuje priamy senzor a aspoÅˆ jeden prevodnÃ­k
    > (napr. chemickÃ½ senzor ktorÃ½ najprv prevedie podnet na chemickÃº
    > reakciu na tepelnÃº energiu a potom prevedie tepelnÃº energiu na
    > elektrickÃº)

**AktÃ­vne a pasÃ­vne senzory**

-   U pasÃ­vneho senzoru je nutnÃ© elektrickÃº veliÄinu odpor, kapacita,
    > indukÄnosÅ¥ Äalej previesÅ¥ na prÃºdovÃ½ signÃ¡l (termistor), vÃ¤ÄÅ¡in
    > pasÃ­vnych senzorov sÃº priame senzory

-   U aktÃ­vneho senzoru sa samotnÃ½ senzor stÃ¡va zdrojom elektrickÃ©ho
    > signÃ¡lu (fotodiÃ³da)

**AbsolÃºtne a relatÃ­vne senzory**

-   AbsolÃºtne merajÃº veliÄinu vzhÄ¾adom k urÄitej absolÃºtnej hodnote, ako
    > u teplotnÃ½ch senzorov napr. voÄi 0âˆ˜C (termistor)

-   TermoÄlÃ¡nok napr. generuje elektrickÃ½ prÃºd ako reakciu na zmenu
    > teploty, ÄiÅ¾e reaguje na zmenu meranej veliÄiny

**Senzory teploty**

![](./assets/media/image24.png){width="5.364583333333333in"
height="2.0520833333333335in"}

SkladÃ¡ sa zo znÃ­macieho elementu, kontaktov a obalu. SnÃ­macÃ­ element je
zodpovednÃ½ za zmenu jeho vlastnej teploty z pÃ´vodnej na snÃ­manÃº, vhodnÃ½
material pre snÃ­macÃ­ element a obal mÃ¡ vysokÃº tepelnÃº vodivosÅ¥ a
citlivosÅ¥. MÃ´Å¾e byÅ¥ kotaktnÃ½ a bezkontaktnÃ½.

**Termistor NTC (**Negative Temprerature Coefficient, **Negistor)**

Je prvok ktorÃ©ho elektrickÃ½ odpor klesÃ¡ s rastÃºcou teplotou - mÃ¡
negatÃ­vny teplotnÃ½ koeficient. ZÃ¡vÃ­slosÅ¥ medzi odporom a teplotou je
nelineÃ¡rna funkcia.

![](./assets/media/image16.png){width="3.4270833333333335in"
height="3.0625in"}![](./assets/media/image26.png){width="5.083333333333333in"
height="2.03125in"}

**6. Princip Å¡Ã­Å™enÃ­ rÃ¡diovÃ©ho signÃ¡lu prostÅ™edÃ­m, vÃ½konovÃ¡ ÃºroveÅˆ
pÅ™ijatÃ©ho signÃ¡lu a jejÃ­ zÃ¡vislost na vzdÃ¡lenosti, popis logaritmickÃ©ho
ÃºtlumovÃ©ho modelu, pÅ™evod dBm na mW, vliv frekvence na vÃ½konovou ÃºroveÅˆ
signÃ¡lu, zisk antÃ©ny, ÄtvrtvlnnÃ© antÃ©ny.**

ElektromagnetickÃ© vlny. Pri pouÅ¾itÃ­ vÅ¡esmerovej antÃ©ny klesÃ¡ intenzita
vyÅ¾arovanÃ©ho signÃ¡lu s kvadrÃ¡tom vzdialenosti (inverse square law).

![](./assets/media/image9.png){width="1.25in" height="0.6875in"}

VÃ½konovÃ¡ ÃºroveÅˆ je vzÅ¥ahovanÃ¡ k vÃ½konu 1 mW, potom pouÅ¾Ã­vame jednotku
dBm. V dBm je vÃ½konovÃ¡ ÃºroveÅˆ ÃºrÄenÃ¡ ako logaritmickÃ½ pomer prijatÃ©ho
vÃ½konu P~r~ \[W\] vzhÄ¾adom k referenÄnej hodnote 1 mW, preto je
zÃ¡kladnou veliÄinou vÃ½konovej Ãºrovne decibel miliwatt - **dBm.**

![](./assets/media/image4.png){width="2.8229166666666665in"
height="0.8125in"}

VÃ½konovÃ¡ ÃºroveÅˆ 0 dBm potom odpovedÃ¡ pomeru Pr/Pt = 1, vÃ½kon je teda Pr
= 1 mW.

![](./assets/media/image23.png){width="2.5833333333333335in"
height="3.5in"}

PrepoÄet z dBm na mW

![](./assets/media/image3.png){width="2.53125in"
height="0.5520833333333334in"}

**LogaritmickÃ½ ÃºtlmovÃ½ model**

![](./assets/media/image8.png){width="3.7604166666666665in"
height="0.75in"}

DÃ¡ sa vyuÅ¾iÅ¥ pre odhad komunikaÄnej vzdialenosti na zÃ¡klade vÃ½konovej
Ãºrovne prijatÃ©ho signÃ¡lu Å¡Ã­renÃ½m reÃ¡lnym rÃ¡diovÃ½m prostredÃ­m. ÃšroveÅˆ
prijatÃ©ho signÃ¡lu Pr(d) vo vzdialenosti d je zÃ¡vislÃ¡ na

1.  Ãšrovni signÃ¡lu Pr(d0) v referenÄnej vzdialenosti d0

2.  Pomere koncovej a referencnej vzdialenosti

3.  Na Ãºtlmovom Äiniteli

4.  Na parametri X ktorÃ½ je nÃ¡hodnÃ¡ premennÃ¡ s rozptylom ğœ ktorÃ¡ v
    > podstate predstavuje predom neznÃ¡my Ãºtlm signÃ¡lu vzniknutÃ½
    > prechodom prekÃ¡Å¾ok, odrazom, difrakciou, Äi ohÃ½bom

![](./assets/media/image20.png){width="4.880208880139983in"
height="1.4937817147856518in"}

**Vplyv frekvencie na vÃ½konovÃº ÃºroveÅˆ signÃ¡lu**

VyÅ¡Å¡ia frekvencia mÃ¡ vyÅ¡Å¡Ã­ vÃ½kon? V skriptÃ¡ch to neni.

**Zisk antÃ©ny**

UvÃ¡dza sa vÃ¤ÄÅ¡inou pre smerovÃ© antÃ©ny a a uÅ¾Ã­vateÄ¾ovi vravÃ­, koÄ¾kokrÃ¡t
vyÅ¡Å¡Ã­ vÃ½kon v najsilnejÅ¡om smere radiÃ¡cie mÃ¡ smerovÃ¡ antÃ©na oproti
antÃ©ne vÅ¡esmerovej. Jednotka dBi (i - isotropic). IdeÃ¡lna izotropickÃ¡
antÃ©na vyÅ¾aruje vo vÅ¡etkÃ½ch smeroch rovnakÃ½m vÃ½konom. Zisk nie je
vzÅ¥aÅ¾enÃ½ len k prijÃ­mu ale aj vysielaniu. Ak mÃ¡ antÃ©na zisk G = 3 dBi
tak bude sila prijatÃ©ho alebo odoslanÃ©ho signÃ¡lu v najsilnejÅ¡om smere
radiÃ¡cie o 3 dB viac ako pri vÅ¡esmerovej antÃ©ne.

**Å tvrÅ¥vlnnÃ© antÃ©ny**

DipÃ³lovÃ¡ a monopÃ³lovÃ¡ antÃ©na. NajÄastejÅ¡ie pouÅ¾Ã­vanÃ© antÃ©ny v
bezdrÃ´tovÃ½ch sieÅ¥ach. MonopÃ³lova antÃ©na je zloÅ¾enÃ¡ z dvoch drÃ´tov,
priÄom kaÅ¾dÃ½ drÃ´t mÃ¡ dÄºÅ¾ku odpovedajÃºcu Å¡tvrtine vlnovej dÄºÅ¾ky ğœ†/4. U
dipÃ³lovej je celkovÃ¡ dÄºÅ¾ka antÃ©ny ğœ†/2.

**7. Standard IEEE 802.15. a jeho rozdÄ›lenÃ­. Definice fyzickÃ© vrstvy dle
IEEE 802.15.4, pouÅ¾itÃ¡ frekvenÄnÃ­ pÃ¡sma, modulace, pÅ™enosovÃ©
rychlosti.**

**Problematika koexistence standardu IEEE 802.15.4 s ostatnÃ­mi
bezdrÃ¡tovÃ½mi technologiemi. Detekce energie na kanÃ¡le, parametr RSSI,
parametr LQI, formÃ¡t rÃ¡mce na fyzickÃ© vrstvÄ› IEEE 802.15.4**

WPAN technolÃ³gie sÃº definovanÃ© Å¡tandardom IEEE 802.15. PrÃ¡ca na
definÃ­cii Å¡tandardov je rozdelenÃ¡ medzi 6 pracovnÃ½ch skupÃ­n 802.15.1 aÅ¾
802.15.7.

**802.15.1**

-   Bluetooth

**802.15.2**

-   rieÅ¡i koexistenciu WPAN s ostatnÃ½mi technolÃ³giami (prevaÅ¾ne 802.11 -
    > wifi)

**802.15.3** a **802.15.4**

-   Å pecifikuje parametre fyzickej (PHY) a linkovej (MAC) vrstvy pre
    > bezdrÃ´tovÃ© zariadenia s krÃ¡tkym dosahom a zameranÃ­m na nÃ­zku
    > spotrebu

-   802.15.3 - **High Rate** WPAN (11-55 Mbps)

-   802.15.4 - **Low Rate** WPAN (pomalÃ©, low energy)

**802.15.5**

-   Å pecifikuje technolÃ³gie umoÅ¾ÅˆujÃºce ÄiastoÄnÃº a plnÃº mesh komunikÃ¡ciu

**802.15.7**

-   MÃ¡ na starosti nÃ¡vrh Å¡tandardov pre zariadenia komunikÃºjuce pomocou
    > technolÃ³gie **VLC** (Visible Light Communication)

**DefinÃ­cia fyzickej vrstvy podÄ¾a 802.15.4**

FyzickÃ¡ vrstva mÃ¡ na starosti

-   Vypnutie a zapnutie rÃ¡diovÃ©ho prijÃ­maÄa

-   Prenos a prÃ­jem dÃ¡t

-   VÃ½ber frekvenÄnÃ©ho kanÃ¡lu

-   Detekciu energie na kanÃ¡le (energy detection, carrier sense?)

-   Zistenie voÄ¾nÃ©ho kanÃ¡lu (Clear Channel Assesment)

-   Zistenie kvality prijÃ­manÃ½ch dÃ¡t pomocou LQI parametre (Link Quality
    > Indication)

![](./assets/media/image31.png){width="6.5in"
height="2.1666666666666665in"}

![](./assets/media/image37.png){width="6.5in" height="1.75in"}

WPAN zdieÄ¾a u kanÃ¡lov 11-26 2,4 GHz pÃ¡smo s 802.11 (wifi). Pre 802.11 v
eurÃ³pe bolo vydanÃ© doporuÄenie pouÅ¾Ã­vaÅ¥ len kanÃ¡ly 1, 7 a 13, z Äoho
vyplÃ½va, Å¾e jedinÃ© voÄ¾nÃ© kanÃ¡ly u WPAN ktorÃ© by sa nemali kryÅ¥ s WiFi sÃº
15, 16, 21 a 22. Takto sa teoreticky minimalizuje prekrytie tÃ½chto
Å¡tandardov, ale v realite je to aj tak bordel a prekrÃ½vanie je stÃ¡le
problÃ©m. Å Ã­rka WPAN kanÃ¡lu bÃ½va 600 kHz.

**RSSI**

Hodnota indikujÃºca ÃºroveÅˆ prijatÃ©ho vÃ½konu na kanÃ¡le. Jednotka je dBm.
Zvykne byÅ¥ uloÅ¾enÃ¡ v status registri rÃ¡dioveho Äipu, alebo za prijatÃ½m
paketom (CC1101).

**Detekcia energie na kanÃ¡le**

SlÃºÅ¾i na zamedzeniu vzniku kolÃ­ziÃ­ pri vysielanÃ­ viacerÃ½ch zariadenÃ­ v
rÃ¡diovom dosahu. IEEE 802.15.4 definuje vyuÅ¾itie prÃ­stup. metÃ³dy CSMA-CA
(collision avoidance). Meria sa energia na kanÃ¡le. PodÄ¾a toho device
vie, Äi mÃ´Å¾e vysielaÅ¥, alebo mÃ¡ poÄkaÅ¥ kÃ½m sa neuvoÄ¾nÃ­ kanÃ¡l. V prÃ­pade
Å¾e je rozdiel medzi detekovanou energiou a citlivosÅ¥ou prijÃ­maÄa vÃ¤ÄÅ¡Ã­
ako stanovenÃ¡ hranica (40 dBm u AT86RF230), oznamuje sa linkovej vrstve
Å¾e je kanÃ¡l obsadenÃ½.

IEEE 802.15.4 definuje 3 modely pre rozhodnutie o obsadenosti kanÃ¡lu
(CCA - Clear Channel Assesment)

1.  CCA Mode 1 - iba energy detection (citlivosÅ¥ +40 dBm)

2.  CCA Mode 2 - detekcia nosnej, rozhoduje sa o obsadenosti detekovanÃ­m
    > nosnÃ©ho signÃ¡lu (ak sa detekuje signÃ¡l ktorÃ½ bol vysielanÃ½ a
    > rozprestrenÃ½ rovnakÃ½mi technikami ako na prijÃ­macej strane, v
    > prÃ­pade 802.15.4 to mÃ´Å¾e byÅ¥ BPSK a O-QPSK spoloÄne s metÃ³dou
    > rozprestrenÃ©ho spektra DSSS)

3.  CCA Mode 3 - kombinÃ¡cia predchÃ¡dzajÃºcich dvoch mÃ³dov

**LQI** (Link Quality Indicator)

Metrika pre urÄenie kvality bezdrÃ´tovÃ©ho spoja. NabÃ½va hodnoty 0 - 255.
0 je najmenÅ¡ia kvalita a 255 je najvyÅ¡Å¡ia kvalita linky. Hodnotu LQI
mÃ´Å¾eme interpretovaÅ¥ ako chybovosÅ¥ prijÃ­manÃ½ch dÃ¡t (PER - packet error
ratio). PER = 1 - ani jeden paket nebol prijatÃ½ sprÃ¡vne.

![](./assets/media/image34.png){width="6.5in"
height="4.763888888888889in"}

Hodnota LQI sa urÄije vÅ¾dy aÅ¾ po Ãºplnom prijatÃ­ rÃ¡mca a skontrolovanÃ­
integrity cez CRC. LQI sa pouÅ¾Ã­va napr. u ZigBee protokolu k nÃ¡jdenÃ­
najspoÄ¾ahlivejÅ¡ej cesty medzi dvoma bezdrÃ´tovÃ½mi jednotkami.

**FormÃ¡t rÃ¡mca na fyzickej vrstve 802.15.4**

![](./assets/media/image18.png){width="6.5in"
height="1.4722222222222223in"}

Max veÄ¾kosÅ¥ synchronizaÄnej hlaviÄky (**SHR** - Synchronization Header)
je 6B a max veÄ¾kosÅ¥ payloadu je 127 B.

SHR zaÄÃ­na 4B preambulou vyplnenou nulami, za Åˆou nasleduje SFD (Start
of Frame Delimiter) s konÅ¡tantou 0xA7. Potom nasleduje byte oznaÄujÃºci
dÄºÅ¾ku payloadu v bajtoch (pouÅ¾Ã­va sa iba 7 bitov, keÄÅ¾e max dÄºÅ¾ka
payloadu je 127 B).

Payload sa potom predÃ¡va linkovej vrstve.

**8. Definice linkovÃ© vrstvy dle IEEE 802.15.4 , formÃ¡t rÃ¡mce, struktura
superrÃ¡mce, typy zaÅ™Ã­zenÃ­, mezirÃ¡mcovÃ© intervaly, synchronizovanÃ¡ a
nesynchronizovanÃ© metoda CSMA/CA.**

LinkovÃ¡ vrstva je oznaÄovanÃ¡ ako MAC (Media Access Control), je
zodpovednÃ¡ za

-   DefinÃ­cia typu zriadenia (RFD/FFD)

    -   802.15.4 definuje dve typy zariadenÃ­ - **FFD** (Fully Function
        > Device) a **RFD** (Reduced Function Device)

    -   **FFD** mÃ´Å¾e slÃºÅ¾iÅ¥ ako PAN-C (koordinÃ¡tor siete), Router, alebo
        > ED (End Device). SmerovaÄ je schopnÃ½ smerovaÅ¥ dÃ¡ta k inÃ½m
        > prvkom siete. KoordinÃ¡tor siete riadi celÃº sieÅ¥ a mÃ¡ jedineÄnÃº
        > adresu 0x00 a vÃ¤ÄÅ¡inou funguje ako brÃ¡na do inÃ½ch sietÃ­.

    -   **RFD** je komunikaÄnÃ© a senzorickÃ© zariadenie ktorÃ© nedisponuje
        > funkciou smerovania dÃ¡t

-   Adresovanie zariadenÃ­

    -   KaÅ¾dÃ© zariadenie mÃ¡ unikÃ¡tnu adresu ktorÃ¡ sa dÃ¡ nakonfigurovaÅ¥
        > alebo je pridelenÃ¡ koordinÃ¡torom siete

    -   802.15.4 definuje zÃ¡kladnÃ½ 16bit formÃ¡t adresy alebo rozÅ¡Ã­renÃ½
        > 64b formÃ¡t

-   DefinÃ­cia topolÃ³gie (hviezda alebo peer-to-peer)

-   Generovanie beacon rÃ¡mcov v prÃ­pade Å¾e je device koordinÃ¡tor siete

-   SynchronizÃ¡cia zariadenÃ­ podÄ¾a hodnÃ´t v beacon rÃ¡mci

-   Vyhradzovanie ÄasovÃ½ch intervalov pre komunikÃ¡cie (GTS - Guarantee
    > Time Slots)

-   Vkladanie medzirÃ¡mcovÃ½ch intervalov

-   VykonÃ¡vanie CSMA-CA

-   Asociovanie zariadenÃ­ do siete a ich odpÃ¡janie

**SuperrÃ¡mec**

KoordinÃ¡tor mÃ´Å¾e synchronizovaÅ¥ sieÅ¥ zasielanÃ­m Beacon rÃ¡mcov. Interval
beacon rÃ¡mcov definuje dobu trvania jednÃ©ho SuperrÃ¡mca (Superframe).
SuperrÃ¡mec sa delÃ­ na viacero ÄastÃ­, ktorÃ© definujÃº, kedy mÃ´Å¾e
zariadenie vysielaÅ¥ a kedy mÃ¡ byÅ¥ neaktÃ­vne (vypnutÃ© radio, sleep mode).
SuperrÃ¡mec je teda **ÄasovÃ½ okamÅ¾ik ohraniÄenÃ½ dvoma Beacon rÃ¡mcami**.

![](./assets/media/image30.png){width="6.5in"
height="2.1666666666666665in"}

SuperrÃ¡mec je rozdelenÃ½ do troch ÄasovÃ½ch intervalov.

**CAP (Contention Access Period)** - po tÃºto dobu mÃ´Å¾u zariadenia voÄ¾ne
vysielaÅ¥ za pouÅ¾itia CSMA-CA

**CFP (Contention Free Period)** - v tomto intervale sa nesÃºperÃ­ o
mÃ©dium, tento interval je rozdelenÃ½ do garantovanÃ½ch ÄasovÃ½ch slotov
**GTS (Guaranteed Time Slots)** pre tie zariadenia, ktorÃ© si o vyhradenÃ©
Äasy zaÅ¾iadali u koordinÃ¡tora. PoÄet GTS intervalov je obmedzenÃ½ na 7 a
kaÅ¾dÃ½ GTS mÃ´Å¾e obsadzovaÅ¥ Ä¾ubovoÄ¾nÃ½ poÄet time slotov.

**Inactive period** - tu sa nevysiela, vypnutÃ© radio

**CAP** a **CFP** majÃº dÄºÅ¾ku dokopy 16 ÄasovÃ½ch slotov premennej dÄºÅ¾ky.
DÄºÅ¾ka slotov zÃ¡visÃ­ na dÄºÅ¾ke trvania aktÃ­vnej doby superrÃ¡mca.

Po zapnutÃ­ si zariadenie vyÅ¾iada beacon rÃ¡mec od koordinÃ¡tora. V beacon
rÃ¡mcoch sÃº prenÃ¡Å¡anÃ© hodnoty podÄ¾a ktorÃ½ch si zariadenia vypoÄÃ­tajÃº kedy
konÄÃ­ aktÃ­vna doba (prejsÅ¥ do reÅ¾imu spÃ¡nku) a kedy sa zas majÃº prebudiÅ¥
pre prijatie ÄalÅ¡ieho beacon rÃ¡mca.

**BI** - beacon interval - interval prenÃ¡Å¡ania beacon rÃ¡mca

**SD** (superframe duration) - doba trvania aktÃ­vnej Äasti superrÃ¡mca

ğµğ¼ = ğ‘ğµğ‘ğ‘ ğ‘’ğ‘†ğ‘¢ğ‘ğ‘’ğ‘Ÿğ‘“ğ‘Ÿğ‘ğ‘šğ‘’ğ·ğ‘¢ğ‘Ÿğ‘ğ‘¡ğ‘–ğ‘œğ‘› x 2^ğµğ‘‚^

ğ‘†ğ· = ğ‘ğµğ‘ğ‘ ğ‘’ğ‘†ğ‘¢ğ‘ğ‘’ğ‘Ÿğ‘“ğ‘Ÿğ‘ğ‘šğ‘’ğ·ğ‘¢ğ‘Ÿğ‘ğ‘¡ğ‘–ğ‘œğ‘› x 2^ğ‘†ğ‘‚^

**BO** a **SO** sÃº prenÃ¡Å¡anÃ© v beacon rÃ¡mci.

ğ‘ğµğ‘ğ‘ ğ‘’ğ‘†ğ‘¢ğ‘ğ‘’ğ‘Ÿğ‘“ğ‘Ÿğ‘ğ‘šğ‘’ğ·ğ‘¢ğ‘Ÿğ‘ğ‘¡ğ‘–ğ‘œğ‘› je definovanÃ© Å¡tandardom ako doba trvania 960
symbolov, jeden symbol obsahuje 4 bity. Pri prenosovej rÃ½chlosti 250
kbps je to 15,36 ms

![](./assets/media/image22.png){width="6.5in"
height="1.2777777777777777in"}

**MedzirÃ¡mcovÃ© intervaly**

![](./assets/media/image19.png){width="6.5in" height="2.375in"}

MedzirÃ¡mcovÃ© intervaly sÃº vkladanÃ© za kaÅ¾dÃ½m prenosom z dÃ´vodu
zohÄ¾adnenia delaye na fyzickej vrstve. Po dobu ich trvania nie je moÅ¾nÃ©
zahÃ¡jiÅ¥ komunikÃ¡ciu. Ak je prenesenÃ½ch viac ako 18 B, vkladÃ¡ sa LIFS
(Long Inter Frame Spacing) dlhÃ½ 40 symbolov, inÃ¡Ä sa vkladÃ¡ SIFS (Short
Inter Frame Spacing) dlhÃ½ 12 symbolov.

Ak sa pouÅ¾Ã­va acknowledgement rÃ¡mcov tak je medzirÃ¡mcovÃ½ interval
vloÅ¾enÃ½ aÅ¾ po prijatÃ­ potvrdenia.

**CSMA-CA**

ZÃ¡kladnou metÃ³dou prÃ­stupu na mÃ©dium u 802.15.4 je detekcia nosnej v
kombinÃ¡cii s CSMA-CA. PouÅ¾Ã­vajÃº FFD aj RFD typy zariadenÃ­.

ExistujÃº tu dva reÅ¾imy CSMA-CA. **ZarovnanÃ¡ metÃ³da CSMA-CA** (Slotted
CSMA-CA) sa pouÅ¾Ã­va v synchornizaovanej sieti. Je spÃºÅ¡Å¥anÃ¡ v
definovanÃ½ch backoff slotoch vnÃºtri jednÃ©ho zo 16 ÄasovÃ½ch slotov
aktÃ­vnej doby superrÃ¡mca. **NezarovnanÃ¡ metÃ³da CSMA-CA** sa pouÅ¾Ã­va v
nesynchronizovanej sieti a mÃ´Å¾e sa spustiÅ¥ hocikedy.

**Å truktÃºra MAC rÃ¡mca**

![](./assets/media/image5.png){width="6.5in"
height="2.2777777777777777in"}

IEEE 802.15.4 definuje na linkovej vrstve 4 typy sprÃ¡v

-   Beacon rÃ¡mec

-   DÃ¡tovÃ½ rÃ¡mec

-   PrÃ­kazovÃ½ rÃ¡mec

-   PotvrdzovacÃ­ rÃ¡mec

VÅ¡eobecne sa rÃ¡mec skladÃ¡ z 3 ÄastÃ­

-   MHR - MAC Header

-   MAC Payload - samotnÃ½ payload

-   MFR - MAC Footer

**Frame Control**

-   **Frame Type** - typ rÃ¡mca (beacon, data, prÃ­kaz, ack)

-   **Security Enabled** - ak je nastavenÃ©, tak bude obsah Å¡ifrovanÃ½ a
    > pouÅ¾ije sa hlaviÄka auxiliary header s info o Å¡ifrovanÃ­

-   **Frame Pending** - zariadenie oznamuje Å¾e mÃ¡ k dispozÃ­cii data,
    > dÃ¡tovÃ½ rÃ¡mec sa potom generuje ak si inÃ© zariadenie poÅ¾iada o dÃ¡ta
    > cez Data Request

-   **Ack Request** - ak sa poÅ¾aduje ACK pre tento rÃ¡mec

-   **PAN ID** - ID PAN siete, duh

-   **Dest. Addressing Mode** a **Source Addressing Mode** - urÄuje Äi
    > sa jednÃ¡ o 16 bit alebo 64 bit adresovanie

-   **Frame Version** - verzia 802.15.4 Å¡tandardu

**Sequence Numbe**r - definuje sekvenÄnÃ© ÄÃ­slo rÃ¡mca

**Dest PAN ID** - self explanatory

**Dest Addr** - self explanatory

**Source PAN ID** - self explanatory

**Source Addr** - self explanatory

**FCS** - Frame Control Sequence, kontrolnÃ½ sÃºÄet CRC

![](./assets/media/image25.png){width="6.064009186351706in"
height="2.5052088801399823in"}

**9. Protokol Zigbee, definice sÃ­Å¥ovÃ© vrstvy, smÄ›rovÃ¡nÃ­ v mesh sÃ­ti
pomocÃ­ AODV, smÄ›rovÃ¡nÃ­ ve stromovÃ© struktuÅ™e.AplikaÄnÃ­ vrstva protokolu
Zigbee, aplikaÄnÃ­ profily, koncovÃ© body (endpoints), zabezpeÄenÃ­
komunikace.**

**Zigbee**

Protokol zaloÅ¾enÃ½ na IEEE 802.15.4, definuje vyÅ¡Å¡iu sieÅ¥ovÃº vrstvu (NWK
Layer) a aplikaÄnÃº vrstvu (APS Layer) a sluÅ¾by pre zabezpeÄenie
komunikÃ¡cie.

Jednou z Ãºloh je rozÅ¡Ã­riÅ¥ jednoskokovÃº komunikÃ¡ciu do modelu, kde mÃ´Å¾u
komunikovaÅ¥ dve zariadenia bez toho aby boli v rÃ¡diovom dosahu pomocou
multi-hop komunikÃ¡cie.

ÄalÅ¡ou Ãºlohou je zabezpeÄenie komunikÃ¡cie Å¡ifrovanÃ­m, definovanie
aplikaÄnÃ½ch profilov, etc. UplatÅˆuje sa prevaÅ¾ne v domÃ¡cej
automatizÃ¡cii.

Typy zariadenÃ­

-   Zigbee Coordinator (IEEE 802.15.4 - PAN-C (FFD))

-   Zigbee Router (IEEE 802.15.4 - Router (FFD))

-   Zigbee End Device (IEEE 802.15.4 - Device (RFD))

**SieÅ¥ovÃ¡ vrstva** (NWK layer)

ImplementÃ¡cia Zigbee musi zaruÄiÅ¥ Å¾e hociktoÃ©r zariadenie bude vedieÅ¥
komunikovaÅ¥ s hociktorÃ½m bez toho aby bolo potreba zvÃ½Å¡iÅ¥ rÃ¡diovÃ½ dosah
komunikaÄnej jednotky. SieÅ¥ovÃ¡ vrstva definuje princÃ­py multihop
komunikÃ¡cie medzi jednotlivÃ½mi uzlami.

HlavnÃ© Ãºlohy vrstvy

-   Config novÃ©ho zariadenia (novÃ¡ jednotka v sieti mÃ´Å¾e byÅ¥ router
    > alebo end device)

-   Spustenie siete (prvÃ© zariadenie v sieti musÃ­ byÅ¥ PAN-C)

-   Pripojenie do siete a odpojenie od siete

-   ZabezpeÄenie sieÅ¥ovej vrstvy

-   Smerovanie v sieti

-   UdrÅ¾iavanie smerovacÃ­ch tabuliek

-   VytvÃ¡ranie tabuliek susednÃ½ch uzlov

Zigbee definuje

-   Unicast

-   Broadcast (adresa 0xffff)

-   Multicast

**StromovÃ¡ Å¡truktÃºra uzlov a smerovanie**

Pri vloÅ¾enÃ­ uzlu do siete je mu priradenÃ¡ 16bit adresa (alebo si ju user
nakonfiguruje sÃ¡m). Zigbee coordinator je koreÅˆ stromu. HÄºbka uzlu
oznaÄuje koÄ¾ko hopov paket vyslanÃ½ uzlom absolvuje, kÃ½m kÃ½m je prijatÃ½
koordinÃ¡torom. StupeÅˆ uzlu je parameter oznaÄujÃºci poÄet ostatnÃ½ch
zariadenÃ­ v rÃ¡diovom dosahu danÃ©ho uzlu. StupeÅˆ celej siete je primernÃ½
poÄet stupÅˆov vÅ¡etkÃ½ch uzlov.

![](./assets/media/image28.png){width="5.348958880139983in"
height="2.937288932633421in"}

Funkcia *Cskip* a hodnoty adries zariadenÃ­ sÃº v stromovej topolÃ³gii
vyuÅ¾itÃ© pri smerovanÃ­ dÃ¡t. SmerovaÄ ktorÃ½ prijal dÃ¡ta najprv skontroluje
Äi je koreÅˆom v ceste paketu. Ak Ã¡no, je paket preposlanÃ½ ÄalÅ¡iemu uzlu.
Ak nie, vypoÄÃ­ta sa adresa uzlu pre ÄalÅ¡Ã­ skok podÄ¾a
kurvanezapamÃ¤tateÄ¾nej rovnice.

**Smerovanie v mesh topolÃ³gii pomocou AODV protokolu**

Ad-hoc On Demand Vector protocol. PrenosovÃ¡ cesta bÃ½va vÃ¤ÄÅ¡inou
vytvÃ¡ranÃ¡ na vyÅ¾iadanie anemusÃ­ byÅ¥ symetrickÃ¡ (tzn. cesty tam a spÃ¤Å¥
nemusia byÅ¥ rovnakÃ©.

Smerovanie je proces vÃ½beru medziÄ¾ahlÃ½ch uzlov pre doruÄenie sprÃ¡vy k
poÅ¾adovanÃ©mu prÃ­jemcovi. Zigbee koordinÃ¡tor a Zigbee smerovaÄe zostavujÃº
smerovacie cesty.

![](./assets/media/image7.png){width="4.197916666666667in"
height="2.0729166666666665in"}

DÄºÅ¾ka cesty L je poÄet uzlov v prenosovej ceste (incl. odosielateÄ¾ a
prÃ­jemca).

OptimÃ¡lna cesta sa volÃ­ na zÃ¡klade kvality spoja, poÄtu skokov a
energetickej nÃ¡roÄnosti, rozhoduje teda **cena spoja**. ÄŒÃ­m je cena
vyÅ¡Å¡ia, tÃ½m je menÅ¡ia pravdepodobnosÅ¥ ÃºspeÅ¡nÃ©ho prijatia paketu. Cena
spoja nenadobÃ½va vyÅ¡Å¡Ã­ch hodnÃ´t ako 7.

Rovnica na vÃ½poÄet ceny spoja na zÃ¡klade pravdepodobnosti prijatia
paketu 75%:

![](./assets/media/image12.png){width="3.2291666666666665in"
height="1.8020833333333333in"}

PravdepodobnosÅ¥ prijatia paketu je zaloÅ¾enÃ¡ na LQI. LQI Å¡kÃ¡la sa rozdelÃ­
do 7 rozsahov, kde kaÅ¾dÃ½ rozdah LQI odpovedÃ¡ konkrÃ©tnej hodnote P. Cena
spoja sa vypoÄÃ­ta zo sÃºÄtu pravdepodobnostÃ­ vÅ¡etkÃ½ch spojov na ceste.

Router a Coordinator si drÅ¾ia smerovacie tabuÄ¾ky. CieÄ¾om tabuÄ¾ky je
nÃ¡jsÅ¥ ÄalÅ¡Ã­ hop. Ak router nemÃ¡ zÃ¡znam o prÃ­jemcovi, paket zahadzuje.

Okrem smerovacej tabuÄ¾ky majÃº devices aj doÄasnÃº smerovaciu tabuÄ¾ku
ktorÃº pouÅ¾Ã­vajÃº pri poslanÃ­ a potvrdenÃ­ smerom k zariadeniu ktorÃ©
poÅ¾adovalo zostavenie cesty. DoÄasnÃ¡ tabuÄ¾ka sa ruÅ¡Ã­ po zostavenÃ­ cesty
alebo vyprÅ¡anÃ­ konkrÃ©tneho ÄasovÃ©ho Ãºseku.

VÅ¡etky zariadenia majÃº tabuÄ¾ku susedov, ktorÃ¡ je aktualizovanÃ¡ stÃ¡le ak
zariadenie prijÃ­me od suseda v rÃ¡diovom dosahu paket. SÃº uloÅ¾enÃ© info o
adrese, kvalite spoja, typu zariadenia, etc.

**AplikaÄnÃ¡ vrstva**

![](./assets/media/image38.png){width="5.010416666666667in"
height="4.03125in"}

APS vytvÃ¡ra rozhranie medzi sieÅ¥ovou a aplikaÄnou vrstvou. V AF sÃº
uloÅ¾enÃ© aplikaÄnÃ© profily Zigbee zariadenÃ­. Jedno Zigbee zariadenie mÃ´Å¾e
hostovaÅ¥ aÅ¾ 240 aplikÃ¡ciÃ­. KaÅ¾dÃ¡ aplikÃ¡cia mÃ¡ unikÃ¡tne ÄÃ­slo 1-240.
Tento identifikÃ¡tor sa nazÃ½va **endpoint**. Endpoint 0 je vyhradenÃ½ pre
ZDO vrstvu. ZDO vytvÃ¡ra rozhranie medzi blokom APS a aAF a mÃ¡ na
starosti konfigurÃ¡ciu zariadenÃ­, napr. KonfigurÃ¡ciu funkcie
(coordinator, router, end device).

Ak adresovaniu individuÃ¡lnych aplikÃ¡ciÃ­ sa pouÅ¾Ã­va endpoint.

**AplikaÄnÃ© profily**

ZaruÄujÃº kombatibilitu zariadenÃ­ rÃ´znych vÃ½robcov pre rovnakÃ© aplikaÄnÃ©
vyuÅ¾itie. Napr. komunikaÄnÃ© zariadenia vÃ½robcu A dokÃ¡Å¾u aktivovaÅ¥ Äidlo
od vÃ½robcu B, ak tieto zariadenia majÃº rovnakÃ½ Zigbee profil. Profil je
identifikovanÃ½ 16bit ÄÃ­slom. Rozdah profilov 0x0000 - 0x7fff je
vyhradenÃ½ pre verejnÃ© profily definovanÃ© Zigbee alianciou.

V roku 2013 tieto profily

-   Zigbee Building Automation

<!-- -->

-   Zigbee Remote Control

-   Zigbee Smart Energy

-   Zigbee Health Care

-   Zigbee Home Automation

-   Zigbee Input Device

-   Zigbee Light Link

-   Zigbee Retail Service

-   Zigbee Telecom Services

-   Zigbee Network Devices

KaÅ¾dÃ½ profil obsahuje niekoÄ¾ko clusterov, kaÅ¾dÃ½ mÃ¡ vlastnÃ© 16bit ÄÃ­slo,
kaÅ¾dÃ½ cluster obsahuje mnoÅ¾inu atribÃºtov (atribÃºt mÃ¡ tieÅ¾ 16bit ID).
AtribÃºty slÃºÅ¾ia pre uloÅ¾enie dÃ¡t (napr. TeplotnÃ© Äidlo ukladÃ¡ nameranÃº
hodnotu do jednÃ©ho z atribÃºtov)

**ZabezpeÄenie prenosu**

Zigbee pouÅ¾Ã­va 128bit AES. Å ifrovacÃ­ kÄ¾ÃºÄ je predkonfigurovanÃ½
uÅ¾Ã­vateÄ¾om.

Pre zabezpeÄenie prenosu sÃº pouÅ¾itÃ© dva typy kÄ¾ÃºÄov. **LinkovÃ½ kÄ¾ÃºÄ**
pre unicast prenosy a **sieÅ¥ovÃ½ kÄ¾ÃºÄ** pre broadcast prenosy. Ak user
nenakonfiguruje kÄ¾ÃºÄ, tak mÃ´Å¾e byÅ¥ distribuovanÃ½ pomocou tzv. **Trust
Center** (napr. coordinator) pomocou key-transport kÄ¾ÃºÄa. Tento kÄ¾ÃºÄ ale
uÅ¾ musÃ­ byÅ¥ predkonfigurovanÃ½ uÅ¾Ã­vateÄ¾om. VÃ½hodou tohto spÃ´sobu je Å¾e
kÄ¾ÃºÄ mÃ´Å¾e byÅ¥ Äasto menenÃ½ z dÃ´vodu zvÃ½Å¡enia bezpeÄnosti.

**10. Lokalizace bezdrÃ¡tovÃ½ch uzlÅ¯, energetickÃ¡ spotÅ™eba pÅ™i pÅ™enosu
dat.**

Proces lokalizÃ¡cie je proces urÄenia polohy prvku v definovanom
priestore. Ak aplikÃ¡cia vyÅ¾aduje znaloÅ¥ polohy zariadenia (napr. zÃ­skaj
dÃ¡ta z juÅ¾nej Äasti senzorov, etc.).

ExistujÃº 3 spÃ´soby

1.  ManuÃ¡lna konfigurÃ¡cia polohy uÅ¾Ã­vateÄ¾om. VÃ½hodou je Å¾e v sieti
    > enmusÃ­ prebehnÃºÅ¥ distribuovanÃ½ lokalizaÄnÃ½ proces a Å¡etrÃ­ sa
    > energia. NevÃ½hodou je neflexibilita.

2.  GPS - nevÃ½hodou je zÃ¡vislosÅ¥ na externom HW a prevaÅ¾ne tieÅ¾ vysokÃ¡
    > spotreba energie

3.  ImplementÃ¡cia optimÃ¡lneho lokalizaÄnÃ©ho algoritmu. ZÃ¡kladnÃ½m
    > princÃ­pom je urÄenie vzdialenosti k zariadeniam, ktorÃ© uÅ¾ poznajÃº
    > svoju polohu

![](./assets/media/image27.png){width="6.5in"
height="2.6527777777777777in"}

ExistujÃº dva typy lokalizaÄnÃ½ch algoritmov

1.  S meranÃ­m vzdialenosti

2.  Bez merania vzdialenosti

    a.  K vyjadreniu vzdialenosti sa pouÅ¾Ã­va poÄet hopov medzi dvoma
        > uzlami

Ak je v sieti skupina zariadenÃ­ ktorÃ© majÃº preddefinovanÃº polohu (tzv.
kotvy), vravÃ­me o kotviacich algoritmoch. Kotvy, kterÃ© nemusÃ­ znÃ¡t svojÃ­
polohu vysÃ­lajÃ­ v pravidelnyÌch intervalech signÃ¡l na rÅ¯znyÌch frekvencÃ­ch
a s rÅ¯znyÌm vysÃ­lacÃ­m vyÌkonem.

PÅ™ed samotnou lokalizacÃ­ je zapotÅ™ebÃ­ provÃ©st mÄ›Å™enÃ­ v prostoru a
vytvoÅ™it databÃ¡zi s

informacemi o mÃ­stÄ›, frekvenci a sÃ­le signÃ¡lu. Lokalizace pak probÃ­hÃ¡ na
zÃ¡kladÄ› porovnÃ¡nÃ­ klÃ­Äe (frekvence a sÃ­la signÃ¡lu) s informacemi v
databÃ¡zi. V tomto pÅ™Ã­padÄ› hovoÅ™Ã­me o kl.ÄovyÌch lokalizaÄnÃ­ch
algoritmech.

Odhad vzdialenosti pomocou RSSI, Time of Arrival, Angle of Arrival
